<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZERA - Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Azonix';
            src: url('fonts/Azonix.otf') format('opentype');
            font-weight: normal;
            font-style: normal;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            color: #fff;
            overflow-x: hidden;
            background-color: #000;
            min-height: 100vh;
            position: relative;
        }

        /* Full-screen iframe background */
        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .background-container iframe {
            width: 100vw;
            height: 100vh;
            border: none;
        }

        /* Make the body pass through pointer events to the background but allow scrolling */
        body {
            pointer-events: none;
            overflow-y: auto !important;
            height: auto !important;
        }

        /* But enable pointer events for all interactive elements */
        header, .dashboard-container, button, .quiz-card, .stats-card, .actions-card {
            pointer-events: auto;
        }

        /* Header */
        header {
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 10;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            font-family: 'Azonix', sans-serif;
            font-size: 28px;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 30px;
        }

        nav ul li a {
            color: #fff;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            padding: 5px 0;
        }

        nav ul li a:hover {
            color: #f0f0f0;
        }

        nav ul li a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #fff;
            transition: width 0.3s ease;
        }

        nav ul li a:hover::after {
            width: 100%;
        }

        nav ul li a.active {
            color: #fff;
        }

        nav ul li a.active::after {
            width: 100%;
        }

        /* Dashboard Container */
        .dashboard-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        .page-title {
            font-family: 'Azonix', sans-serif;
            font-size: 36px;
            color: #fff;
            text-align: center;
            margin-bottom: 40px;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.7);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Stats Section */
        .stats-section {
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-family: 'Azonix', sans-serif;
            font-size: 24px;
            color: #fff;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .stat-card {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #fff;
        }

        .stat-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Recent Quizzes Section */
        .recent-quizzes {
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .quiz-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .quiz-card {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .quiz-card:hover {
            background-color: rgba(0, 0, 0, 0.7);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* Highlight for the most recent quiz */
        .quiz-card.highlight {
            background-color: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            animation: pulse 2s infinite;
        }

        .quiz-card.highlight::before {
            content: 'Latest Quiz';
            position: absolute;
            top: 10px;
            right: -30px;
            background-color: rgba(255, 255, 255, 0.9);
            color: #000;
            padding: 5px 30px;
            font-size: 12px;
            transform: rotate(45deg);
            font-weight: bold;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }
            50% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.5); }
            100% { box-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }
        }

        .quiz-info {
            flex: 1;
        }

        .quiz-title {
            font-weight: 500;
            font-size: 16px;
            margin-bottom: 5px;
            color: #fff;
        }

        .quiz-meta {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .quiz-score {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 700;
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Actions Section */
        .actions-section {
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 40px;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .action-card {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .action-card:hover {
            background-color: rgba(0, 0, 0, 0.7);
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .action-icon {
            font-size: 36px;
            margin-bottom: 15px;
            color: #fff;
        }

        .action-title {
            font-family: 'Azonix', sans-serif;
            font-size: 18px;
            color: #fff;
            margin-bottom: 10px;
        }

        .action-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
        }

        /* Performance Chart Section */
        .performance-section {
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 40px;
        }

        .chart-container {
            width: 100%;
            height: 300px;
            position: relative;
            margin-top: 20px;
        }

        .chart-bar {
            position: absolute;
            bottom: 0;
            width: 40px;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.7), rgba(255, 255, 255, 0.3));
            border-radius: 5px 5px 0 0;
            transition: height 1s ease;
        }

        .chart-label {
            position: absolute;
            bottom: -25px;
            width: 40px;
            text-align: center;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Download Report Button */
        .download-section {
            text-align: center;
            margin-top: 40px;
            margin-bottom: 60px;
        }

        .download-btn {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.5));
            color: #fff;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 40px;
            border-radius: 30px;
            font-family: 'Azonix', sans-serif;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3), 0 0 10px rgba(255, 255, 255, 0.1);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), 0 0 15px rgba(255, 255, 255, 0.2);
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.6));
            border-color: rgba(255, 255, 255, 0.5);
        }

        .download-icon {
            font-size: 24px;
        }

        /* Spline credit removal */
        .spline-credit-overlay {
            position: fixed;
            bottom: 0;
            right: 0;
            width: 200px;
            height: 50px;
            background-color: #000;
            z-index: 1000;
        }

        /* Additional overlay for complete coverage */
        .background-container:after {
            content: '';
            position: fixed;
            bottom: 0;
            right: 0;
            width: 200px;
            height: 50px;
            background-color: #000;
            z-index: 999;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">QUIZERA</div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="feature.html">Features</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="dashboard.html" class="active">Dashboard</a></li>
            </ul>
        </nav>
    </header>

    <!-- Background iframe -->
    <div class="background-container">
        <iframe src='https://my.spline.design/rippleeffect-yDiapKXpd4yaWvaYRABjj8Kr/' frameborder='0' width='100%' height='100%'></iframe>
    </div>

    <!-- Spline credit overlay -->
    <div class="spline-credit-overlay"></div>

    <div class="dashboard-container">
        <h1 class="page-title">Your Dashboard</h1>

        <div class="dashboard-grid">
            <!-- Stats Section -->
            <div class="stats-section">
                <h2 class="section-title">Performance Stats</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-quizzes">0</div>
                        <div class="stat-label">Quizzes Taken</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avg-score">0%</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-questions">0</div>
                        <div class="stat-label">Questions Answered</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="best-score">0%</div>
                        <div class="stat-label">Best Score</div>
                    </div>
                </div>
            </div>

            <!-- Recent Quizzes Section -->
            <div class="recent-quizzes">
                <h2 class="section-title">Recent Quizzes</h2>
                <div class="quiz-list" id="quiz-list">
                    <!-- Quiz cards will be added here dynamically -->
                </div>
            </div>
        </div>

        <!-- Actions Section -->
        <div class="actions-section">
            <h2 class="section-title">Quick Actions</h2>
            <div class="actions-grid">
                <div class="action-card" onclick="window.location.href='llm-quiz.html'">
                    <div class="action-icon">üéÆ</div>
                    <div class="action-title">New Quiz</div>
                    <div class="action-description">Start a new quiz with your preferred AI model and topic</div>
                </div>
                <div class="action-card" id="download-report-card">
                    <div class="action-icon">üìä</div>
                    <div class="action-title">Download Report</div>
                    <div class="action-description">Get a detailed PDF report of your quiz performance</div>
                </div>
                <div class="action-card" id="view-last-quiz-card">
                    <div class="action-icon">üîç</div>
                    <div class="action-title">View Last Quiz</div>
                    <div class="action-description">Review your most recent quiz results</div>
                </div>
            </div>
        </div>

        <!-- Performance Chart Section -->
        <div class="performance-section">
            <h2 class="section-title">Performance Trend</h2>
            <div class="chart-container" id="performance-chart">
                <!-- Chart bars will be added here dynamically -->
            </div>
        </div>

        <!-- Download Report Button -->
        <div class="download-section">
            <button class="download-btn" id="download-report-btn">
                <span class="download-icon">üì•</span>
                Download Comprehensive Report
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Try to remove Spline credit (if possible)
            setTimeout(function() {
                try {
                    const iframe = document.querySelector('.background-container iframe');
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const splineElements = iframeDoc.querySelectorAll('a[href*="spline"], div[class*="spline"], div[id*="spline"]');
                    splineElements.forEach(el => el.style.display = 'none');

                    // Additional attempt to remove any Spline branding
                    const allElements = iframeDoc.querySelectorAll('*');
                    allElements.forEach(el => {
                        if (el.textContent && el.textContent.includes('Spline')) {
                            el.style.display = 'none';
                        }
                    });
                } catch(e) {
                    console.log('Could not access iframe content due to same-origin policy');
                }
            }, 2000);

            // Load quiz data from localStorage
            const loadQuizData = () => {
                // Get all quiz results from localStorage
                const quizResults = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('quizResult_')) {
                        try {
                            const result = JSON.parse(localStorage.getItem(key));
                            quizResults.push(result);
                        } catch (e) {
                            console.error('Error parsing quiz result:', e);
                        }
                    }
                }

                // Sort by date (most recent first)
                quizResults.sort((a, b) => new Date(b.date) - new Date(a.date));

                return quizResults;
            };

            // Update stats
            const updateStats = (quizResults) => {
                if (quizResults.length === 0) {
                    return;
                }

                const totalQuizzes = quizResults.length;
                document.getElementById('total-quizzes').textContent = totalQuizzes;

                let totalScore = 0;
                let totalQuestions = 0;
                let bestScore = 0;

                quizResults.forEach(result => {
                    const score = result.percentage || 0;
                    totalScore += score;
                    totalQuestions += result.total || 0;
                    bestScore = Math.max(bestScore, score);
                });

                const avgScore = totalQuizzes > 0 ? Math.round(totalScore / totalQuizzes) : 0;

                document.getElementById('avg-score').textContent = avgScore + '%';
                document.getElementById('total-questions').textContent = totalQuestions;
                document.getElementById('best-score').textContent = bestScore + '%';
            };

            // Update recent quizzes list
            const updateRecentQuizzes = (quizResults) => {
                const quizList = document.getElementById('quiz-list');
                quizList.innerHTML = '';

                // Show up to 5 most recent quizzes
                const recentQuizzes = quizResults.slice(0, 5);

                if (recentQuizzes.length === 0) {
                    quizList.innerHTML = '<p style="text-align: center; color: rgba(255, 255, 255, 0.7);">No quizzes taken yet</p>';
                    return;
                }

                // Check if we should highlight the most recent quiz
                const highlightLatest = new URLSearchParams(window.location.search).get('newQuiz') === 'true';

                recentQuizzes.forEach((quiz, index) => {
                    const quizCard = document.createElement('div');
                    quizCard.className = 'quiz-card';

                    // Add highlight class to the most recent quiz if coming from quiz completion
                    if (index === 0 && highlightLatest) {
                        quizCard.classList.add('highlight');
                    }

                    const quizInfo = document.createElement('div');
                    quizInfo.className = 'quiz-info';

                    const quizTitle = document.createElement('div');
                    quizTitle.className = 'quiz-title';
                    quizTitle.textContent = quiz.pdfName || 'Quiz';

                    const quizMeta = document.createElement('div');
                    quizMeta.className = 'quiz-meta';

                    const quizDate = document.createElement('span');
                    quizDate.textContent = new Date(quiz.date).toLocaleDateString();

                    const quizType = document.createElement('span');
                    quizType.textContent = quiz.format || 'Mixed';

                    const quizDifficulty = document.createElement('span');
                    quizDifficulty.textContent = quiz.difficulty || 'Medium';

                    quizMeta.appendChild(quizDate);
                    quizMeta.appendChild(quizType);
                    quizMeta.appendChild(quizDifficulty);

                    quizInfo.appendChild(quizTitle);
                    quizInfo.appendChild(quizMeta);

                    const quizScore = document.createElement('div');
                    quizScore.className = 'quiz-score';
                    quizScore.textContent = (quiz.percentage || 0) + '%';

                    quizCard.appendChild(quizInfo);
                    quizCard.appendChild(quizScore);

                    quizList.appendChild(quizCard);

                    // If this is the highlighted quiz, scroll to it and show a welcome message
                    if (index === 0 && highlightLatest) {
                        setTimeout(() => {
                            quizCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            showWelcomeMessage(quiz);
                        }, 500);
                    }
                });
            };

            // Update performance chart
            const updatePerformanceChart = (quizResults) => {
                const chartContainer = document.getElementById('performance-chart');
                chartContainer.innerHTML = '';

                // Show up to 10 most recent quizzes (in chronological order)
                const chartData = quizResults.slice(0, 10).reverse();

                if (chartData.length === 0) {
                    chartContainer.innerHTML = '<p style="text-align: center; color: rgba(255, 255, 255, 0.7);">No data available</p>';
                    return;
                }

                const maxHeight = 250; // Maximum height for bars
                const barWidth = 40;
                const barSpacing = 20;
                const totalWidth = chartData.length * (barWidth + barSpacing);

                // Center the bars if there are fewer than can fill the container
                const containerWidth = chartContainer.offsetWidth;
                const startX = Math.max(0, (containerWidth - totalWidth) / 2);

                chartData.forEach((quiz, index) => {
                    const percentage = quiz.percentage || 0;
                    const barHeight = (percentage / 100) * maxHeight;

                    const bar = document.createElement('div');
                    bar.className = 'chart-bar';
                    bar.style.height = '0'; // Start at 0 for animation
                    bar.style.left = `${startX + index * (barWidth + barSpacing)}px`;
                    bar.style.width = `${barWidth}px`;

                    const label = document.createElement('div');
                    label.className = 'chart-label';
                    label.textContent = new Date(quiz.date).toLocaleDateString().split('/').slice(0, 2).join('/');
                    label.style.left = `${startX + index * (barWidth + barSpacing)}px`;

                    chartContainer.appendChild(bar);
                    chartContainer.appendChild(label);

                    // Animate the bar height after a short delay
                    setTimeout(() => {
                        bar.style.height = `${barHeight}px`;
                    }, 100 + index * 100);
                });
            };

            // Generate and download PDF report
            const generatePDFReport = () => {
                alert('Generating PDF report...\n\nIn a real implementation, this would generate a comprehensive PDF report with all your quiz results, performance statistics, and detailed analysis of your strengths and weaknesses.');

                // Simulate download delay
                setTimeout(() => {
                    alert('PDF report generated successfully!');
                }, 1500);
            };

            // Show welcome message after completing a quiz
            const showWelcomeMessage = (quiz) => {
                // Create a welcome toast message
                const toast = document.createElement('div');
                toast.className = 'welcome-toast';
                toast.innerHTML = `
                    <div class="toast-header">
                        <span class="toast-icon">üéâ</span>
                        <span class="toast-title">Quiz Completed!</span>
                        <span class="toast-close">&times;</span>
                    </div>
                    <div class="toast-body">
                        <p>Congratulations! You scored <strong>${quiz.percentage}%</strong> on your quiz.</p>
                        <p>Your results have been saved to your dashboard.</p>
                    </div>
                `;

                // Add toast styles
                const style = document.createElement('style');
                style.textContent = `
                    .welcome-toast {
                        position: fixed;
                        bottom: 30px;
                        right: 30px;
                        background-color: rgba(0, 0, 0, 0.8);
                        color: #fff;
                        padding: 15px;
                        border-radius: 10px;
                        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
                        z-index: 1000;
                        max-width: 350px;
                        border: 1px solid rgba(255, 255, 255, 0.2);
                        animation: slideIn 0.5s forwards;
                    }

                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }

                    .toast-header {
                        display: flex;
                        align-items: center;
                        margin-bottom: 10px;
                        padding-bottom: 10px;
                        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                    }

                    .toast-icon {
                        font-size: 24px;
                        margin-right: 10px;
                    }

                    .toast-title {
                        font-family: 'Azonix', sans-serif;
                        font-size: 18px;
                        flex: 1;
                    }

                    .toast-close {
                        cursor: pointer;
                        font-size: 20px;
                        opacity: 0.7;
                    }

                    .toast-close:hover {
                        opacity: 1;
                    }

                    .toast-body {
                        line-height: 1.5;
                    }

                    .toast-body p {
                        margin: 5px 0;
                    }

                    .toast-body strong {
                        color: #fff;
                    }
                `;

                document.head.appendChild(style);
                document.body.appendChild(toast);

                // Add close functionality
                toast.querySelector('.toast-close').addEventListener('click', () => {
                    toast.style.animation = 'slideOut 0.5s forwards';
                    setTimeout(() => {
                        document.body.removeChild(toast);
                    }, 500);
                });

                // Auto-close after 8 seconds
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        toast.style.animation = 'slideOut 0.5s forwards';
                        setTimeout(() => {
                            if (document.body.contains(toast)) {
                                document.body.removeChild(toast);
                            }
                        }, 500);
                    }
                }, 8000);

                // Add slideOut animation
                const slideOutStyle = document.createElement('style');
                slideOutStyle.textContent = `
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(slideOutStyle);
            };

            // Initialize dashboard
            const initDashboard = () => {
                const quizResults = loadQuizData();
                updateStats(quizResults);
                updateRecentQuizzes(quizResults);
                updatePerformanceChart(quizResults);

                // Add event listeners
                document.getElementById('download-report-btn').addEventListener('click', generatePDFReport);
                document.getElementById('download-report-card').addEventListener('click', generatePDFReport);

                // Add event listener for View Last Quiz button
                document.getElementById('view-last-quiz-card').addEventListener('click', () => {
                    // Get the most recent quiz result
                    const latestQuiz = quizResults[0];
                    if (latestQuiz) {
                        // Save it as the current quiz result for the results page
                        localStorage.setItem('quizResults', JSON.stringify(latestQuiz));
                        window.location.href = 'results.html';
                    } else {
                        alert('No quiz results available yet. Take a quiz first!');
                    }
                });

                // Update URL to remove the query parameter without refreshing the page
                if (window.history && window.history.replaceState) {
                    const url = new URL(window.location.href);
                    url.searchParams.delete('newQuiz');
                    window.history.replaceState({}, document.title, url.toString());
                }
            };

            // Initialize the dashboard
            initDashboard();

            // For demo purposes, add some sample data if none exists
            if (loadQuizData().length === 0) {
                const sampleQuizzes = [
                    {
                        pdfName: 'Quantum Physics',
                        date: new Date(Date.now() - 1000 * 60 * 60 * 24 * 1).toISOString(),
                        format: 'Multiple Choice',
                        difficulty: 'Hard',
                        percentage: 85,
                        score: 17,
                        total: 20,
                        timeTaken: '12:45'
                    },
                    {
                        pdfName: 'World History',
                        date: new Date(Date.now() - 1000 * 60 * 60 * 24 * 3).toISOString(),
                        format: 'Mixed Format',
                        difficulty: 'Medium',
                        percentage: 92,
                        score: 23,
                        total: 25,
                        timeTaken: '15:30'
                    },
                    {
                        pdfName: 'Machine Learning',
                        date: new Date(Date.now() - 1000 * 60 * 60 * 24 * 5).toISOString(),
                        format: 'Fill in the Blanks',
                        difficulty: 'Hard',
                        percentage: 78,
                        score: 14,
                        total: 18,
                        timeTaken: '10:15'
                    },
                    {
                        pdfName: 'Biology Basics',
                        date: new Date(Date.now() - 1000 * 60 * 60 * 24 * 8).toISOString(),
                        format: 'True/False',
                        difficulty: 'Easy',
                        percentage: 95,
                        score: 19,
                        total: 20,
                        timeTaken: '08:20'
                    },
                    {
                        pdfName: 'Programming in Python',
                        date: new Date(Date.now() - 1000 * 60 * 60 * 24 * 12).toISOString(),
                        format: 'Multiple Choice',
                        difficulty: 'Medium',
                        percentage: 88,
                        score: 22,
                        total: 25,
                        timeTaken: '14:10'
                    }
                ];

                // Store sample quizzes in localStorage
                sampleQuizzes.forEach((quiz, index) => {
                    localStorage.setItem(`quizResult_sample_${index}`, JSON.stringify(quiz));
                });

                // Refresh the dashboard
                initDashboard();
            }
        });
    </script>
</body>
</html>
